{% extends "base.html" %}
{% block content %}

<div class="page-header" style="display:flex;justify-content:space-between;align-items:flex-end;gap:12px;flex-wrap:wrap">
  <div>
    <h1 style="margin:0">Utilisateurs</h1>
    <p class="muted" style="margin:0">Liste des comptes enregistrés</p>
  </div>
  <div style="display:flex;gap:8px;flex-wrap:wrap">
    <a class="btn ghost" href="{{ url_for('admin_home') }}">⟵ Retour admin</a>
    <a class="btn ghost" href="{{ url_for('players') }}">Voir la page publique</a>
  </div>
</div>

<div class="card">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
    <h3 style="margin:0">Comptes ({{ users|length }})</h3>
    <input id="userFilter" class="input" placeholder="Filtrer par nom ou email…" oninput="filterUsers()" style="min-width:260px">
  </div>

  <div class="table-wrap" style="margin-top:10px; overflow:auto">
    <table class="table">
      <thead>
        <tr>
          <th style="white-space:nowrap">ID</th>
          <th>Nom</th>
          <th>Email</th>
          <th style="white-space:nowrap">Admin</th>
          <th style="white-space:nowrap">Créé le</th>
        </tr>
      </thead>
      <tbody id="usersBody">
        {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.name }}</td>
          <td><a href="mailto:{{ u.email }}">{{ u.email }}</a></td>
          <td>
            {% if u.is_admin %}
              <span class="tag">Oui</span>
            {% else %}
              <span class="tag" style="background:var(--line);color:var(--text)">Non</span>
            {% endif %}
          </td>
          <td>{{ u.created_at.strftime('%Y-%m-%d %H:%M') if u.created_at else '—' }}</td>
        </tr>
        {% else %}
        <tr><td colspan="5" class="muted">Aucun utilisateur.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <p class="hint" style="margin-top:8px">Cette page est en lecture seule. (Pas d’actions car aucune route d’édition n’est définie dans l’application.)</p>
</div>

<script>
  function filterUsers() {
    const q = (document.getElementById('userFilter').value || '').toLowerCase();
    document.querySelectorAll('#usersBody tr').forEach(tr => {
      const text = tr.innerText.toLowerCase();
      tr.style.display = text.includes(q) ? '' : 'none';
    });
  }
</script>

{% endblock %}
